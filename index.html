<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>YAKAMOZ</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  height:100vh;        /* â­ min-height DEÄÄ°L */
  overflow:hidden;    /* â­ SAYFA SCROLL KAPALI */
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:
    linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.45)),
    url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e');
  background-size:cover;
  background-position:center;
}

/* ORTAK */
.screen{
  display:none;
  height:100vh;     /* â­ */
}

.centerScreen{display:flex;align-items:center;justify-content:center;}

/* GLASS */
.glassBox{
  background:rgba(255,255,255,.25);
  backdrop-filter:blur(12px);
  border-radius:20px;
  padding:30px 25px;
  width:90%;
  max-width:360px;
  text-align:center;
}
.glassBox h2{color:#fff;}
.glassBox input{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:12px;
  border:none;
}
.glassBox button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  background:#25D366;
  color:#fff;
  font-weight:bold;
}

/* CHAT LAYOUT */
#chatScreen{
  display:flex;
  justify-content:center;
  height:100vh;        /* â­ */
  overflow:hidden;     /* â­ */
}
#chatLayout{
  width:100%;
  max-width:1600px;
  height:100%;
  display:grid;
  grid-template-columns:260px 1fr 260px;
  gap:20px;
  padding:20px;
  box-sizing:border-box; /* â­ BU YOKSA TAÅAR */
}

/* SIDE */
.side{
  display:flex;
  flex-direction:column;
  gap:15px;
}
.note{
  background:rgba(255,255,255,.25);
  backdrop-filter:blur(12px);
  border-radius:16px;
  padding:14px;
  color:#fff;
  font-size:13px;
}
.note h4{margin:0 0 6px;font-size:14px;}

/* CHAT CENTER */
.center{
  display:flex;
  flex-direction:column;
  background:rgba(0,0,0,.55);
  height:100%;
  min-height:0;
  overflow:hidden; /* â­ */
}
#chatHeader{
  background:rgba(255,255,255,.9);
  text-align:center;
  padding:15px;
  font-weight:600;
}
#chat{
  flex:1;
  overflow-y:auto;
  min-height:0;   /* â­ BU SATIRI EKLE */
  padding:15px;
  background:
    linear-gradient(rgba(0,0,0,.65),rgba(0,0,0,.65)),
    url("https://images.unsplash.com/photo-1519681393784-d120267933ba");
  background-size:cover;
  background-position:center;
}

/* MESSAGE */
.msgWrap{
  display:flex;
  gap:8px;
  align-items:flex-end;
  margin-bottom:10px;
  width:100%;                 /* ğŸ”´ Ã–NEMLÄ° */
}
.msg{
  max-width:65%;
  padding:12px 14px;
  border-radius:22px;
  font-size:16px;
}
.me{
  background:#25D366;
  color:#fff;
  margin-left:auto;   /* SAÄA Ä°TER */
}

.other{
  background:#fff;
  margin-right:auto;  /* SOLA Ä°TER */
}


.avatar{
  width:40px;
  height:40px;
  border-radius:50%;
  object-fit:cover;
}

/* SEND */
#sendBar{
  background:rgba(255,255,255,.9);
  display:flex;
  gap:10px;
  padding:10px;
}
#sendBar input{
  flex:1;
  padding:12px;
  border-radius:25px;
  border:1px solid #ddd;
}
#sendBar button{
  padding:0 18px;
  border-radius:25px;
  border:none;
  background:#25D366;
  color:#fff;
  font-weight:bold;
}

/* WHEEL */
.wheelBox{
  background:rgba(255,255,255,.25);
  backdrop-filter:blur(12px);
  border-radius:16px;
  padding:15px;
  text-align:center;
}
.wheelBox button{
  margin-top:10px;
  padding:8px 16px;
  border:none;
  border-radius:20px;
  background:#25D366;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
#wheelResult{
  margin-top:8px;
  color:white;
  font-weight:600;
}
.msg.wheel{
  background:linear-gradient(135deg,#ffe259,#ffa751);
  color:#4a2c00;
  font-weight:600;
  text-align:center;
}


/* MOBILE */
@media(max-width:900px){
  #chatLayout{grid-template-columns:1fr;}
  .side{display:none;}
}
/* ğŸ§ MUSIC CARD */
.musicCard{
  background:rgba(255,255,255,.25);
  backdrop-filter:blur(12px);
  border-radius:18px;
  padding:14px;
  color:#fff;
}

.albumCover{
  position:relative;
  width:100%;
  aspect-ratio:1/1; /* KARE */
  border-radius:14px;
  overflow:hidden;
  margin-bottom:10px;
}

.albumCover img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.playIcon{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:40px;
  background:rgba(0,0,0,.35);
  opacity:0;
  transition:.3s;
  cursor:pointer;
}

.albumCover:hover .playIcon{
  opacity:1;
}

.musicInfo{
  display:flex;
  flex-direction:column;
  gap:4px;
}

.song{
  font-weight:600;
  font-size:14px;
}

.artist{
  font-size:12px;
  opacity:.85;
}
/* ğŸ½ï¸ RECIPE CARD */
.recipeCard{
  position:relative;
  width:100%;
  height:450px;            /* ğŸ”´ UZUNLUK BURADAN */
  border-radius:18px;
  overflow:hidden;
  background:
    linear-gradient(rgba(0,0,0,.4),rgba(0,0,0,.4)),
    url("https://i.hizliresim.com/1ncm0p5.png");
  background-size:cover;
  background-position:center;
  color:#fff;
}

.recipeOverlay{
  position:absolute;
  bottom:0;
  width:100%;
  padding:16px;
  background:linear-gradient(
    rgba(0,0,0,0),
    rgba(0,0,0,0.75)
  );
}

.recipeOverlay h4{
  margin:0;
  font-size:15px;
  font-weight:600;
}

.recipeOverlay p{
  margin:4px 0 0;
  font-size:13px;
  opacity:.95;
}
.recipeOverlay:empty::before{
  content:"Tarifini yazâ€¦";
  color:#ddd;
}
.balimsuNote{
  background:linear-gradient(135deg,#ffb6d9,#ffc1e3);
  color:#4a1f33;
  font-size:14px;
}

.balimsuNote h4{
  font-size:15px;
  font-weight:600;
}
.balimsuNote{
  min-height:300px;      /* ğŸ”´ UZUNLUK */
  padding:20px;          /* iÃ§ boÅŸluk */
}
#emojiBtn{
  background:none;
  border:none;
  font-size:22px;
  cursor:pointer;
}

#emojiPanel{
  position:absolute;
  bottom:70px;
  left:50%;
  transform:translateX(-50%);
  background:#fff;
  border-radius:16px;
  padding:10px;
  display:none;
  width:280px;
  box-shadow:0 8px 30px rgba(0,0,0,.25);
  z-index:999;
}
#emojiPanel{
  max-height:220px;
  overflow-y:auto;
}


#emojiPanel span{
  font-size:22px;
  padding:6px;
  cursor:pointer;
}

#emojiPanel span:hover{
  background:#f2f2f2;
  border-radius:8px;
  transform:scale(1.2);
}
.systemWrap{
  display:flex;
  justify-content:center;
  margin:12px 0;
}

.systemMsg{
  background:rgba(255,255,255,.9);
  color:#333;
  font-size:15px;
  padding:12px 20px;
  border-radius:18px;
  max-width:80%;
  text-align:center;
  box-shadow:0 4px 12px rgba(0,0,0,.18);
}
.msgTime{
  font-size:11px;
  opacity:.6;
  margin-top:4px;
  text-align:right;
}

.other + .msgTime{
  text-align:left;
}

#noteText{
  width:92%;
  height:200px;
  border:none;
  border-radius:12px;
  padding:12px;
  resize:none;
  font-size:14px;
  background:rgba(255,255,255,.85);
}

.pageControls{
  display:flex;
  justify-content:space-between;
  margin-top:8px;
}

.pageControls button{
  border:none;
  padding:6px 14px;
  border-radius:12px;
  background:#fff;
  cursor:pointer;
}
/* ğŸ“„ DEFTER YAPRAK ANÄ°MASYONU */
.notePage{
  animation-duration: .45s;
  animation-fill-mode: both;
}

.pageNext{
  animation-name: pageNext;
}

.pagePrev{
  animation-name: pagePrev;
}

@keyframes pageNext{
  from{
    opacity:0;
    transform:translateX(40px) rotateY(-8deg);
  }
  to{
    opacity:1;
    transform:translateX(0) rotateY(0);
  }
}

@keyframes pagePrev{
  from{
    opacity:0;
    transform:translateX(-40px) rotateY(8deg);
  }
  to{
    opacity:1;
    transform:translateX(0) rotateY(0);
  }
} 
/* ğŸ“• DEFTER KAPAÄI */
.notebookCover{
  position:relative;
  background:linear-gradient(135deg,#3b1f2b,#5a2b3f);
  border-radius:18px;
  padding:18px;
  box-shadow:
    inset 0 0 0 2px rgba(255,255,255,.15),
    0 10px 30px rgba(0,0,0,.35);
}

/* taÅŸlÄ± dÃ¼ÄŸme */
.coverButton{
  position:absolute;
  top:12px;
  right:12px;
  width:18px;
  height:18px;
  border-radius:50%;
  background:radial-gradient(circle,#ffd6ff,#c77dff,#7b2cbf);
  box-shadow:0 0 8px rgba(255,214,255,.8);
}

/* deri dokusu hissi */
.notebookCover::after{
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(
      45deg,
      rgba(255,255,255,.03),
      rgba(255,255,255,.03) 2px,
      transparent 2px,
      transparent 6px
    );
  pointer-events:none;
}

/* ğŸ”– SAYFA AYIRACI */
.bookmark{
  position:absolute;
  right:-6px;
  top:60px;
  width:20px;
  height:70px;
  background:linear-gradient(#ffb703,#fb8500);
  border-radius:0 6px 6px 0;
  box-shadow:0 4px 12px rgba(0,0,0,.3);
}

.bookmark::after{
  content:"";
  position:absolute;
  bottom:-10px;
  left:0;
  width:0;
  height:0;
  border-left:10px solid transparent;
  border-right:10px solid transparent;
  border-top:10px solid #fb8500;
}
/* ğŸ“• KAPAK AÃ‡ / KAPA */
.notebookCover{
  perspective:1200px;
  overflow:hidden;
}

.coverLayer{
  position:absolute;
  inset:0;
  background: linear-gradient(
    135deg,
    #0050ff,
    #1f7bff,
    #4da3ff
  );

  border-radius:18px;
  transform-origin:left;
  transition:transform .6s ease;
  z-index:5;

  box-shadow:
    0 0 30px rgba(50,120,255,.75),
    inset 0 0 20px rgba(255,255,255,.25);
}


/* deri hissi */
.coverLayer::after{
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(
      45deg,
      rgba(255,255,255,.04),
      rgba(255,255,255,.04) 2px,
      transparent 2px,
      transparent 6px
    );
}

.notebookOpen .coverLayer{
  transform:rotateY(-160deg);
}

.notebookContent{
  position:relative;
  z-index:1;
}
/* âœ¨ KAPAK PARLAMA */
.coverGlow{
  position:absolute;
  inset:0;
  border-radius:18px;
  background:radial-gradient(
    circle at left,
    rgba(255,255,255,.45),
    rgba(255,255,255,0) 60%
  );
  opacity:0;
  pointer-events:none;
}

.notebookOpen .coverGlow{
  animation:glowFlash .6s ease;
}

@keyframes glowFlash{
  0%{opacity:0}
  40%{opacity:1}
  100%{opacity:0}
}
/* ğŸª¶ TÃœYLÃœ KAPAK DOKUSU */
.furLayer{
  position:absolute;
  inset:0;
  border-radius:18px;
  background:
    radial-gradient(circle at 20% 30%, rgba(255,200,220,.55), transparent 35%),
    radial-gradient(circle at 70% 40%, rgba(255,180,210,.45), transparent 40%),
    radial-gradient(circle at 40% 70%, rgba(255,170,200,.4), transparent 45%),
    repeating-linear-gradient(
      60deg,
      rgba(255,190,220,.25),
      rgba(255,190,220,.25) 2px,
      transparent 2px,
      transparent 6px
    );
  filter:blur(1.8px);
  opacity:1;
  mix-blend-mode:screen; /* ğŸ”¥ ASIL OLAY */
  pointer-events:none;
}


/* aÃ§Ä±lÄ±rken kapakla birlikte dÃ¶nsÃ¼n */
.coverLayer .furLayer{
  transform-origin:left;
}
/* ğŸ–¼ï¸ KAPAK FOTO ALANI */
.coverPhotos{
  position:absolute;
  top:45px;
  left:50%;
  transform:translateX(-50%);
  width:70%;
  height:280px; /*defter kapaÄŸÄ±ndaki foto yÃ¼ksekliÄŸi */
  border-radius:14px;
  overflow:hidden;
  background:rgba(255,255,255,.25);
  box-shadow:0 0 18px rgba(0,0,0,.35);
  z-index:6;
}

.coverPhotos img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.coverCaption{
  position:absolute;
  bottom:0;
  width:100%;
  padding:6px 8px;
  font-size:12px;
  color:#fff;
  background:rgba(0,0,0,.35);
  backdrop-filter:blur(4px);
  text-align:center;
}

.coverPrev,
.coverNext{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:rgba(255,255,255,.8);
  border:none;
  border-radius:50%;
  width:26px;
  height:26px;
  cursor:pointer;
}

.coverPrev{ left:6px; }
.coverNext{ right:6px; }


</style>
</head>

<body>

<!-- NAME -->
<div id="nameScreen" class="screen centerScreen">
  <div class="glassBox">
    <h2>AdÄ±n</h2>
    <input id="usernameInput" placeholder="Ad">
    <input id="avatarInput" placeholder="Profil FotoÄŸrafÄ± (URL)">
    <button onclick="saveName()">Devam</button>
  </div>
</div>

<!-- LOGIN -->
<div id="login" class="screen centerScreen">
  <div class="glassBox">
    <h2>Sohbet OdamÄ±za HoÅŸgeldin â¤ï¸</h2>
    <input id="roomName" placeholder="Oda adÄ±">
    <input id="roomPass" type="password" placeholder="Åifre">
    <button onclick="joinRoom()">Gir</button>
    <p id="error" style="color:#ffdede;"></p>
  </div>
</div>

<!-- CHAT -->
<div id="chatScreen" class="screen">
  <div id="chatLayout">

    <div class="side">

 <!-- ğŸ§ GÃœNÃœN ÅARKISI -->
<div class="musicCard">

  <div class="albumCover" onclick="toggleAudio()">
    <img id="coverImg" src="https://i.hizliresim.com/4ki4ypt.png">
    <div class="playIcon" id="playIcon">â–¶</div>
  </div>

  <div class="musicInfo">
    <span class="song" id="songTitle">Racismo</span>
    <span class="artist" id="artistName">Sergio Contreras</span>
  </div>

  <div style="display:flex;justify-content:space-between;margin-top:10px;">
    <button onclick="prevSong()">â®ï¸</button>
    <button onclick="nextSong()">â­ï¸</button>
  </div>

  <audio id="audioPlayer"></audio>

</div>




  <!-- ğŸ¥‘ ÅEKERSÄ°Z TARÄ°F -->
  <div class="recipeCard">
  <div class="recipeOverlay" contenteditable="true">
    <h4>ğŸ¥‘ Åekersiz Tarif</h4>
    <p>Buraya tarifini yazâ€¦</p>
  </div>
</div>


</div>




    <div class="center">
      <div id="chatHeader">yakamaz ğŸ’—<span id="roomNameHeader"></span></div>
      <div id="chat"></div>
      <div id="sendBar">
        <input id="messageInput" placeholder="Mesaj yaz">
        <button id="emojiBtn">ğŸ˜Š</button>
        <button onclick="sendMessage()">GÃ¶nder</button>
      </div>
    </div>

 <div class="side">

<div class="note balimsuNote">

  <div class="coverLayer" onclick="toggleCover()">

  <div class="coverPhotos">
    <img id="coverPhoto" />
    <div class="coverCaption" id="coverCaption"></div>

    <button class="coverPrev" onclick="event.stopPropagation(); prevCoverPhoto()">â¬…</button>
    <button class="coverNext" onclick="event.stopPropagation(); nextCoverPhoto()">â¡</button>
  </div>

  <div class="furLayer"></div>
  <div class="coverGlow"></div>

</div>


  <div class="coverButton" onclick="toggleCover()"></div>

  <div class="notebookContent">
    <h4>ğŸ““ Azreal kuÅŸumla birbirimize Ã¶neriler ğŸ’—</h4>

    <div id="pageInfo">Sayfa 1 / 6</div>

    <div class="bookmark"></div>

    <textarea id="noteText" class="notePage"
      placeholder="birbirimize Ã¶neriyoruzzz ğŸ’—"></textarea>

    <div class="pageControls">
      <button onclick="prevPage()">ğŸ‘ˆğŸ»</button>
      <button onclick="nextPage()">ğŸ‘‰ğŸ»</button>
    </div>
  </div>

</div>

  <div class="note">
    <h4>ğŸ’­ Ã–zlÃ¼ SÃ¶z</h4>
    Sessizlik bazen en gÃ¼zel cevaptÄ±r.
  </div>

  <div class="wheelBox">
    <canvas id="wheel" width="220" height="220"></canvas>
    <button onclick="spinWheel()">Ã‡evir</button>
    <div id="wheelResult"></div>
  </div>

</div>


</div>

<script>
const firebaseConfig={
  apiKey:"AIzaSyCncBeeKKga2SQMbf7VpvgDnS9bnC_KWi4",
  authDomain:"ozel-chat-1ed06.firebaseapp.com",
  projectId:"ozel-chat-1ed06"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

let username=localStorage.getItem("username")||"";
let avatar=localStorage.getItem("avatar")||"";
let room="";

window.onload=()=>show(username?"login":"nameScreen");

function show(id){
  document.querySelectorAll(".screen").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="flex";
}

function saveName(){
  if(!usernameInput.value) return;
  localStorage.setItem("username",usernameInput.value);
  localStorage.setItem("avatar",avatarInput.value);
  username=usernameInput.value;
  avatar=avatarInput.value;
  show("login");
}

async function joinRoom(){
  const rn=roomName.value, rp=roomPass.value;
  if(!rn||!rp) return;
  const ref=db.collection("rooms").doc(rn);
  const doc=await ref.get();
  if(!doc.exists) await ref.set({pass:rp,users:1});
  else{
    if(doc.data().pass!==rp) return error.innerText="Åifre yanlÄ±ÅŸ";
    await ref.update({users:doc.data().users+1});
  }
  room=rn;
  roomNameHeader.innerText=room;
  show("chatScreen");
  listenMessages();
  listenPage();
}

function sendMessage(){
  if(!messageInput.value) return;
  db.collection("rooms").doc(room).collection("messages").add({
    user:username,
    avatar:avatar,
    text:messageInput.value,
    time: firebase.firestore.FieldValue.serverTimestamp()
  });
  messageInput.value="";
}
function formatTime(ts){
  const d = ts.toDate();
  return d.toLocaleTimeString("tr-TR", {
    hour: "2-digit",
    minute: "2-digit"
  });
}

function listenMessages(){
  db.collection("rooms").doc(room).collection("messages")
  .orderBy("time").onSnapshot(s=>{
    chat.innerHTML="";

    s.forEach(d=>{
      if(d.metadata.hasPendingWrites) return;

      const m = d.data();
      if(!m.time) return;

      let wrap;

if(m.type === "wheel"){
  wrap = document.createElement("div");
  wrap.className = "systemWrap";
} else {
  wrap = document.createElement("div");
  wrap.className = "msgWrap";
}


      if(m.user !== username && m.avatar){
        const img = document.createElement("img");
        img.src = m.avatar;
        img.className = "avatar";
        wrap.appendChild(img);
      }

      const div = document.createElement("div");

if(m.type === "wheel"){
  div.className = "systemMsg";
  div.innerHTML = `
    ğŸ¡ <b>${m.user}</b> Ã§ark Ã§evirdi<br>
    ${m.result}
  `;
} else {

  div.className = "msg " + (m.user === username ? "me" : "other");
  div.innerHTML = `
  <b>${m.user}</b><br>
  ${m.text}
  <div class="msgTime">${formatTime(m.time)}</div>
`;
}

wrap.appendChild(div);


      if(m.user === username && m.avatar){
        const img = document.createElement("img");
        img.src = m.avatar;
        img.className = "avatar";
        wrap.appendChild(img);
      }

      chat.appendChild(wrap);
    });

    chat.scrollTop = chat.scrollHeight;
  });
}

/* ğŸ¡ WHEEL */
const wheel=document.getElementById("wheel");
const ctx=wheel.getContext("2d");
const items=[
  "â˜•ğŸ”¥ğŸ’­ Kahve iÃ§",
  "ğŸ¶ğŸ§âœ¨ ÅarkÄ± aÃ§",
  "ğŸ’¬ğŸ“±ğŸ’™ Mesaj at",
  "ğŸŒ¬ï¸ğŸ«ğŸ§˜ Derin nefes",
  "ğŸš¶â€â™‚ï¸ğŸŒ¿ğŸŒ YÃ¼rÃ¼",
  "ğŸ“âœï¸ğŸ““ Not yaz",
  "ğŸŒ¸ğŸ‘ƒâœ¨ ParfÃ¼m dene",
  "ğŸµğŸ”„ğŸ§ MÃ¼zik deÄŸiÅŸtir",
  "ğŸ¤«ğŸŒ™ğŸ–¤ Sus",
  "ğŸ˜„ğŸ˜Šâœ¨ GÃ¼l",
  "ğŸ’§ğŸš°ğŸŒŠ Su iÃ§",
  "ğŸ“¸âœ¨ğŸ–¼ï¸ Foto Ã§ek",
  "ğŸ“–ğŸ’­âœ¨ AnÄ± yaz",
  "â¸ï¸ğŸ›‘ğŸ§  Dur",
  "â¡ï¸ğŸ”¥ğŸš€ Devam et",
  "ğŸ˜ŒğŸ§˜â€â™€ï¸ğŸŒ™ Rahatla"
];
let angle=0;

function drawWheel(){
  const r=wheel.width/2;
  const slice=(2*Math.PI)/items.length;
  ctx.clearRect(0,0,wheel.width,wheel.height);
  items.forEach((t,i)=>{
    ctx.beginPath();
    ctx.moveTo(r,r);
    ctx.arc(r,r,r,angle+i*slice,angle+(i+1)*slice);
    ctx.fillStyle=`hsl(${i*360/items.length},70%,60%)`;
    ctx.fill();
    ctx.save();
    ctx.translate(r,r);
    ctx.rotate(angle+i*slice+slice/2);
    ctx.textAlign="right";
    ctx.fillStyle="#000";
    ctx.font="12px sans-serif";
    ctx.fillText(t,r-10,5);
    ctx.restore();
  });
}
drawWheel();

function spinWheel(){
  const extra = Math.random() * 10 + 10; // daha fazla tur
  const targetAngle = angle + extra * Math.PI * 2;
  const start = performance.now();
  const duration = 2500;

  function animate(t){
    const p = Math.min((t - start) / duration, 1);
    const ease = 1 - Math.pow(1 - p, 3); // ease-out
    angle = angle + (targetAngle - angle) * ease;
    drawWheel();

    if(p < 1){
      requestAnimationFrame(animate);
    } else {
      angle = targetAngle;
      showResult();
    }
  }
  requestAnimationFrame(animate);
}

function showResult(){
  const slice = (2 * Math.PI) / items.length;

  const normalized =
    (2 * Math.PI - (angle % (2 * Math.PI)) + slice / 2) % (2 * Math.PI);

  const index = Math.floor(normalized / slice);
  const result = items[index];

  // ğŸ”¥ FIRESTORE'A KAYDET
  db.collection("rooms").doc(room).collection("messages").add({
    type: "wheel",
    user: username,
    result: result,
    time: firebase.firestore.FieldValue.serverTimestamp()
  });
}


const songs = [
  {
    title: "Racismo",
    artist: "en en en sevdiklerimdenğŸ†ğŸ¡ğŸš€",
    src: "music/racismoo.mp3",
    cover: "https://i.hizliresim.com/4ki4ypt.png"
  },
  {
    title: "Town",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’—ğŸ†ğŸœ",
    src: "music/town.mp3",
    cover: "https://i.hizliresim.com/34ei7qk.png"
  },
  {
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndan Ëš.ğŸ€à¼˜â‹†",
    src: "music/motii.mp3",
    cover: "https://i.hizliresim.com/ark715q.png"
  },
{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ¦šğŸ™ˆğŸ§",
    src: "music/whoopp.mp3",
    cover: "https://i.hizliresim.com/5xnb47u.png"
  },
{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ«‚ğŸª¼ğŸŒº",
    src: "music/Entrance.mp3",
    cover: "https://i.hizliresim.com/c70lmre.png"
  },
{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/adalente.mp3",
    cover: "https://i.hizliresim.com/ms48r63.png"
  },
{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/touch.mp3",
    cover: "https://i.hizliresim.com/4ofzlxm.png"
  },
{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/1.mp3",
    cover: "https://i.hizliresim.com/7eqkq6f.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/2.mp3",
    cover: "https://i.hizliresim.com/e60vci6.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/3.mp3",
    cover: "https://i.hizliresim.com/mxfk8ms.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/4.mp3",
    cover: "https://i.hizliresim.com/t648tdc.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/5.mp3",
    cover: "https://i.hizliresim.com/i0m6n8h.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/6.mp3",
    cover: "https://i.hizliresim.com/g0fxfwu.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/7.mp3",
    cover: "https://i.hizliresim.com/amdnybn.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/8.mp3",
    cover: "https://i.hizliresim.com/7pyzogl.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/9.mp3",
    cover: "https://i.hizliresim.com/nuv085a.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/10.mp3",
    cover: "https://i.hizliresim.com/io0o5n5.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/11.mp3",
    cover: "https://i.hizliresim.com/ruzb4q3.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "Ã§ok Ã¼zÃ¼cÃ¼ ama Ã§okzelğŸ’ğŸ§¡ğŸ’˜",
    src: "music/12.mp3",
    cover: "https://i.hizliresim.com/7plgblz.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "nakaratÄ± Ã§okzeelğŸŒºğŸŒ¿ğŸ¤",
    src: "music/13.mp3",
    cover: "https://i.hizliresim.com/fu3rysr.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "bu ÅŸarkÄ± sensinğŸ’ğŸ§¡ğŸ’˜",
    src: "music/14.mp3",
    cover: "https://i.hizliresim.com/ptd97o9.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "senin vibeÄ±n gibiğŸŒºğŸŒ¿ğŸ¤",
    src: "music/15.mp3",
    cover: "https://i.hizliresim.com/93lvgbn.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "en az 10 yÄ±ldÄ±r favğŸ’ğŸ§¡ğŸ’˜",
    src: "music/16.mp3",
    cover: "https://i.hizliresim.com/io3loc2.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "zamazingooooğŸŒºğŸŒ¿ğŸ¤",
    src: "music/17.mp3",
    cover: "https://i.hizliresim.com/b4y8mzh.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/18.mp3",
    cover: "https://i.hizliresim.com/lado7y8.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/19.mp3",
    cover: "https://i.hizliresim.com/d3eewun.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "rus rapinin atatÃ¼rkÃ¼ğŸŒºğŸŒ¿ğŸ¤",
    src: "music/20.mp3",
    cover: "https://i.hizliresim.com/oftuak5.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "rus rapinin atatÃ¼rkÃ¼ğŸ’ğŸ§¡ğŸ’˜",
    src: "music/21.mp3",
    cover: "https://i.hizliresim.com/6p9uc0o.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/22.mp3",
    cover: "https://i.hizliresim.com/32jbs3q.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "rus rapinin atatÃ¼rkÃ¼ğŸŒºğŸŒ¿ğŸ¤",
    src: "music/23.mp3",
    cover: "https://i.hizliresim.com/e53umr0.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "rus rapinin atatÃ¼rkÃ¼ğŸŒºğŸŒ¿ğŸ¤",
    src: "music/24.mp3",
    cover: "https://i.hizliresim.com/86uvb65.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/25.mp3",
    cover: "https://i.hizliresim.com/t2fqte4.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/26.mp3",
    cover: "https://i.hizliresim.com/bapgc37.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "ÅŸarkÄ±yÄ± kulaÄŸÄ±mdan iÃ§eri sokasÄ±m geliyoduğŸ’ğŸ§¡ğŸ’˜",
    src: "music/27.mp3",
    cover: "https://i.hizliresim.com/mii8xt4.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "russ favlarÄ±mdaa bayÄ±lÄ±yomğŸ’ğŸ§¡ğŸ’˜",
    src: "music/28.mp3",
    cover: "https://i.hizliresim.com/q18mxxi.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "aÅŸÄ±rÄ±Ä± gÃ¼zelll ğŸŒºğŸŒ¿ğŸ¤",
    src: "music/29.mp3",
    cover: "https://i.hizliresim.com/g7f62ef.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "BalÄ±msu favlarÄ±ndanğŸ’ğŸ§¡ğŸ’˜",
    src: "music/30.mp3",
    cover: "https://i.hizliresim.com/gjiv6wu.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "rusÃ§aaa favlarÄ±mdanğŸŒºğŸŒ¿ğŸ¤",
    src: "music/31.mp3",
    cover: "https://i.hizliresim.com/bij5we3.png"
  },{
    title: "aÅŸÄ±rÄ± hype edicek ",
    artist: "ilk tÃ¼rkÃ§e ÅŸarkÄ±mÄ±zzğŸ’ğŸ§¡ğŸ’˜",
    src: "music/32.mp3",
    cover: "https://i.hizliresim.com/kv2b2nq.png"
  },
];

let currentSong = 0;
let isPlaying = false;

const audio = document.getElementById("audioPlayer");
const playIcon = document.getElementById("playIcon");
const songTitle = document.getElementById("songTitle");
const artistName = document.getElementById("artistName");
const coverImg = document.getElementById("coverImg");

function loadSong(index){
  const song = songs[index];
  audio.src = song.src;
  songTitle.innerText = song.title;
  artistName.innerText = song.artist;
  coverImg.src = song.cover;
}

function toggleAudio(){
  if(!isPlaying){
    audio.play();
    playIcon.innerText = "â¸";
    isPlaying = true;
  } else {
    audio.pause();
    playIcon.innerText = "â–¶";
    isPlaying = false;
  }
}

function nextSong(){
  currentSong = (currentSong + 1) % songs.length;
  loadSong(currentSong);
  audio.play();
  playIcon.innerText = "â¸";
  isPlaying = true;
}

function prevSong(){
  currentSong = (currentSong - 1 + songs.length) % songs.length;
  loadSong(currentSong);
  audio.play();
  playIcon.innerText = "â¸";
  isPlaying = true;
}

loadSong(currentSong);

window.addEventListener("load", () => {
  const emojiBtn = document.getElementById("emojiBtn");
  const emojiPanel = document.getElementById("emojiPanel");

  if(!emojiBtn || !emojiPanel) return; // ekstra gÃ¼venlik

  emojiBtn.onclick = () => {
    emojiPanel.style.display =
      emojiPanel.style.display === "block" ? "none" : "block";
  };

  emojiPanel.addEventListener("click", e => {
    if(e.target.tagName === "SPAN"){
      messageInput.value += e.target.innerText;
      messageInput.focus();
      emojiPanel.style.display = "none";
    }
  });
});
const messageInput = document.getElementById("messageInput");

messageInput.addEventListener("keydown", function(e){
  if(e.key === "Enter"){
    e.preventDefault();
    sendMessage();
  }
});
let currentPage = 1;
const totalPages = 6;
let unsubscribeNote = null;

function listenPage(){
  if(unsubscribeNote) unsubscribeNote();

  const ref = db
    .collection("rooms")
    .doc(room)
    .collection("notebook")
    .doc("page" + currentPage);

  unsubscribeNote = ref.onSnapshot(doc=>{
    if(doc.exists){
      noteText.value = doc.data().text || "";
    } else {
      noteText.value = "";
    }
  });

  pageInfo.innerText = `Sayfa ${currentPage} / ${totalPages}`;

  updateBookmark(); // ğŸ”– AYIRACI GÃœNCELLE
}


noteText.addEventListener("input", ()=>{
  const ref = db
    .collection("rooms")
    .doc(room)
    .collection("notebook")
    .doc("page" + currentPage);

  ref.set({
    text: noteText.value,
    updatedBy: username,
    time: firebase.firestore.FieldValue.serverTimestamp()
  });
});

function nextPage(){
  if(currentPage < totalPages){
    noteText.classList.remove("pagePrev");
    noteText.classList.add("pageNext");

    setTimeout(()=>{
      currentPage++;
      listenPage();
      noteText.classList.remove("pageNext");
    }, 200);
  }
}


function prevPage(){
  if(currentPage > 1){
    noteText.classList.remove("pageNext");
    noteText.classList.add("pagePrev");

    setTimeout(()=>{
      currentPage--;
      listenPage();
      noteText.classList.remove("pagePrev");
    }, 200);
  }
}
function updateBookmark(){
  const ratio = currentPage / totalPages;
  document.querySelector(".bookmark").style.top =
    40 + ratio * 120 + "px";
}
let coverOpen = false;

function toggleCover(){
  const cover = document.querySelector(".balimsuNote");
  coverOpen = !coverOpen;
  cover.classList.toggle("notebookOpen", coverOpen);
}

const coverPhotos = [
  { src:"https://i.hizliresim.com/i5ix9t2.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/2ixwb6i.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/qpmxa0m.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/rrj32sl.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/sd896sq.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/ibbzfpc.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/lv1swng.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/12mu707.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/hnp50og.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" },
  { src:"https://i.hizliresim.com/cmj2sqo.png", text:"AZREAL VE BALIMSU DEFTERÄ°ğŸ’™" }
];

let coverIndex = 0;

function showCoverPhoto(){
  coverPhoto.src = coverPhotos[coverIndex].src;
  coverCaption.textContent = coverPhotos[coverIndex].text;
}

function nextCoverPhoto(){
  coverIndex = (coverIndex + 1) % coverPhotos.length;
  showCoverPhoto();
}

function prevCoverPhoto(){
  coverIndex = (coverIndex - 1 + coverPhotos.length) % coverPhotos.length;
  showCoverPhoto();
}

showCoverPhoto();


</script>
<div id="emojiPanel">
  <span>ğŸ˜€</span><span>ğŸ˜ƒ</span><span>ğŸ˜„</span><span>ğŸ˜</span><span>ğŸ˜†</span><span>ğŸ˜…</span><span>ğŸ¤£</span><span>ğŸ˜‚</span>
  <span>ğŸ™‚</span><span>ğŸ™ƒ</span><span>ğŸ« </span><span>ğŸ˜‰</span><span>ğŸ˜Š</span><span>ğŸ˜‡</span><span>ğŸ¥°</span><span>ğŸ˜</span>
  <span>ğŸ¤©</span><span>ğŸ˜˜</span><span>ğŸ˜—</span><span>â˜ºï¸</span><span>ğŸ˜š</span><span>ğŸ˜™</span><span>ğŸ¥²</span><span>ğŸ˜‹</span>
  <span>ğŸ˜›</span><span>ğŸ˜œ</span><span>ğŸ¤ª</span><span>ğŸ˜</span><span>ğŸ¤‘</span><span>ğŸ¤—</span><span>ğŸ¤­</span><span>ğŸ«¢</span>
  <span>ğŸ«£</span><span>ğŸ¤«</span><span>ğŸ¤”</span><span>ğŸ«¡</span><span>ğŸ¤</span><span>ğŸ¤¨</span><span>ğŸ˜</span><span>ğŸ˜‘</span>
  <span>ğŸ˜¶</span><span>ğŸ«¥</span><span>ğŸ˜¶â€ğŸŒ«ï¸</span><span>ğŸ˜</span><span>ğŸ˜’</span><span>ğŸ™„</span><span>ğŸ˜¬</span><span>ğŸ˜®â€ğŸ’¨</span>
  <span>ğŸ¤¥</span><span>ğŸ«¨</span><span>ğŸ™‚â€â†”ï¸</span><span>ğŸ™‚â€â†•ï¸</span><span>ğŸ˜Œ</span><span>ğŸ˜”</span><span>ğŸ˜ª</span><span>ğŸ¤¤</span>
  <span>ğŸ˜´</span><span>ğŸ«©</span><span>ğŸ˜·</span><span>ğŸ¤’</span><span>ğŸ¤•</span><span>ğŸ¤¢</span><span>ğŸ¤®</span><span>ğŸ¤§</span>
  <span>ğŸ¥µ</span><span>ğŸ¥¶</span><span>ğŸ¥´</span><span>ğŸ˜µ</span><span>ğŸ˜µâ€ğŸ’«</span><span>ğŸ¤¯</span><span>ğŸ¤ </span><span>ğŸ¥³</span>
  <span>ğŸ¥¸</span><span>ğŸ˜</span><span>ğŸ¤“</span><span>ğŸ§</span><span>ğŸ˜•</span><span>ğŸ«¤</span><span>ğŸ˜Ÿ</span><span>ğŸ™</span>
  <span>â˜¹ï¸</span><span>ğŸ˜®</span><span>ğŸ˜¯</span><span>ğŸ˜²</span><span>ğŸ˜³</span><span>ğŸ¥º</span><span>ğŸ¥¹</span><span>ğŸ˜¦</span>
  <span>ğŸ˜§</span><span>ğŸ˜¨</span><span>ğŸ˜°</span><span>ğŸ˜¥</span><span>ğŸ˜¢</span><span>ğŸ˜­</span><span>ğŸ˜±</span><span>ğŸ˜–</span>
  <span>ğŸ˜£</span><span>ğŸ˜</span><span>ğŸ˜“</span><span>ğŸ˜©</span><span>ğŸ˜«</span><span>ğŸ¥±</span><span>ğŸ˜¤</span><span>ğŸ˜¡</span>
  <span>ğŸ˜ </span><span>ğŸ¤¬</span><span>ğŸ˜ˆ</span><span>ğŸ‘¿</span><span>ğŸ’€</span><span>â˜ ï¸</span><span>ğŸ’©</span><span>ğŸ¤¡</span>
  <span>ğŸ‘¹</span><span>ğŸ‘º</span><span>ğŸ‘»</span><span>ğŸ‘½</span><span>ğŸ‘¾</span><span>ğŸ¤–</span><span>ğŸ˜º</span><span>ğŸ˜¸</span>
  <span>ğŸ˜¹</span><span>ğŸ˜»</span><span>ğŸ˜¼</span><span>ğŸ˜½</span><span>ğŸ™€</span><span>ğŸ˜¿</span><span>ğŸ˜¾</span><span>ğŸ™ˆ</span>
  <span>ğŸ™‰</span><span>ğŸ™Š</span><span>ğŸ’Œ</span><span>ğŸ’˜</span><span>ğŸ’</span><span>ğŸ’–</span><span>ğŸ’—</span><span>ğŸ’“</span>
  <span>ğŸ’</span><span>ğŸ’•</span><span>ğŸ’Ÿ</span><span>â£ï¸</span><span>ğŸ’”</span><span>â¤ï¸â€ğŸ”¥</span><span>â¤ï¸â€ğŸ©¹</span><span>â¤ï¸</span>
  <span>ğŸ©·</span><span>ğŸ§¡</span><span>ğŸ’›</span><span>ğŸ’š</span><span>ğŸ’™</span><span>ğŸ©µ</span><span>ğŸ’œ</span><span>ğŸ¤</span>
  <span>ğŸ–¤</span><span>ğŸ©¶</span><span>ğŸ¤</span><span>ğŸ’‹</span><span>ğŸ’¯</span><span>ğŸ’¢</span><span>ğŸ’¥</span><span>ğŸ’«</span>
  <span>ğŸ’¦</span><span>ğŸ’¨</span><span>ğŸ•³ï¸</span><span>ğŸ’¬</span><span>ğŸ‘ï¸â€ğŸ—¨ï¸</span><span>ğŸ—¨ï¸</span><span>ğŸ—¯ï¸</span><span>ğŸ’­</span>
</div>

</body>
</html>

